<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The World Age mechanism · The Julia Language</title><meta name="title" content="The World Age mechanism · The Julia Language"/><meta property="og:title" content="The World Age mechanism · The Julia Language"/><meta property="twitter:title" content="The World Age mechanism · The Julia Language"/><meta name="description" content="Documentation for The Julia Language."/><meta property="og:description" content="Documentation for The Julia Language."/><meta property="twitter:description" content="Documentation for The Julia Language."/><meta property="og:url" content="https://docs.julialang.org/en/v1/manual/worldage/"/><meta property="twitter:url" content="https://docs.julialang.org/en/v1/manual/worldage/"/><link rel="canonical" href="https://docs.julialang.org/en/v1/manual/worldage/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-28835595-6"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-28835595-6', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/julia-manual.css" rel="stylesheet" type="text/css"/><link href="../../assets/julia.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="The Julia Language logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="The Julia Language logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Julia Documentation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../variables/">Variables</a></li><li><a class="tocitem" href="../integers-and-floating-point-numbers/">Integers and Floating-Point Numbers</a></li><li><a class="tocitem" href="../mathematical-operations/">Mathematical Operations and Elementary Functions</a></li><li><a class="tocitem" href="../complex-and-rational-numbers/">Complex and Rational Numbers</a></li><li><a class="tocitem" href="../strings/">Strings</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../control-flow/">Control Flow</a></li><li><a class="tocitem" href="../variables-and-scoping/">Scope of Variables</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../methods/">Methods</a></li><li><a class="tocitem" href="../constructors/">Constructors</a></li><li><a class="tocitem" href="../conversion-and-promotion/">Conversion and Promotion</a></li><li><a class="tocitem" href="../interfaces/">Interfaces</a></li><li><a class="tocitem" href="../modules/">Modules</a></li><li><a class="tocitem" href="../documentation/">Documentation</a></li><li><a class="tocitem" href="../metaprogramming/">Metaprogramming</a></li><li><a class="tocitem" href="../arrays/">Single- and multi-dimensional Arrays</a></li><li><a class="tocitem" href="../missing/">Missing Values</a></li><li><a class="tocitem" href="../networking-and-streams/">Networking and Streams</a></li><li><a class="tocitem" href="../parallel-computing/">Parallel Computing</a></li><li><a class="tocitem" href="../asynchronous-programming/">Asynchronous Programming</a></li><li><a class="tocitem" href="../multi-threading/">Multi-Threading</a></li><li><a class="tocitem" href="../distributed-computing/">Multi-processing and Distributed Computing</a></li><li><a class="tocitem" href="../running-external-programs/">Running External Programs</a></li><li><a class="tocitem" href="../calling-c-and-fortran-code/">Calling C and Fortran Code</a></li><li><a class="tocitem" href="../handling-operating-system-variation/">Handling Operating System Variation</a></li><li><a class="tocitem" href="../environment-variables/">Environment Variables</a></li><li><a class="tocitem" href="../embedding/">Embedding Julia</a></li><li><a class="tocitem" href="../code-loading/">Code Loading</a></li><li><a class="tocitem" href="../profile/">Profiling</a></li><li><a class="tocitem" href="../stacktraces/">Stack Traces</a></li><li><a class="tocitem" href="../performance-tips/">Performance Tips</a></li><li><a class="tocitem" href="../workflow-tips/">Workflow Tips</a></li><li><a class="tocitem" href="../style-guide/">Style Guide</a></li><li><a class="tocitem" href="../faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../noteworthy-differences/">Noteworthy Differences from other Languages</a></li><li><a class="tocitem" href="../unicode-input/">Unicode Input</a></li><li><a class="tocitem" href="../command-line-interface/">Command-line Interface</a></li><li class="is-active"><a class="tocitem" href>The World Age mechanism</a><ul class="internal"><li><a class="tocitem" href="#World-age-in-general"><span>World age in general</span></a></li><li><a class="tocitem" href="#Temporarily-raising-the-world-age-using-invokelatest"><span>Temporarily raising the world age using <code>invokelatest</code></span></a></li><li><a class="tocitem" href="#World-age-and-const-struct-redefinitions"><span>World age and const struct redefinitions</span></a></li><li><a class="tocitem" href="#World-age-and-using/import"><span>World age and <code>using</code>/<code>import</code></span></a></li><li><a class="tocitem" href="#World-age-capture"><span>World age capture</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Base</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../base/base/">Essentials</a></li><li><a class="tocitem" href="../../base/collections/">Collections and Data Structures</a></li><li><a class="tocitem" href="../../base/math/">Mathematics</a></li><li><a class="tocitem" href="../../base/numbers/">Numbers</a></li><li><a class="tocitem" href="../../base/strings/">Strings</a></li><li><a class="tocitem" href="../../base/arrays/">Arrays</a></li><li><a class="tocitem" href="../../base/parallel/">Tasks</a></li><li><a class="tocitem" href="../../base/multi-threading/">Multi-Threading</a></li><li><a class="tocitem" href="../../base/scopedvalues/">Scoped Values</a></li><li><a class="tocitem" href="../../base/constants/">Constants</a></li><li><a class="tocitem" href="../../base/file/">Filesystem</a></li><li><a class="tocitem" href="../../base/io-network/">I/O and Network</a></li><li><a class="tocitem" href="../../base/punctuation/">Punctuation</a></li><li><a class="tocitem" href="../../base/sort/">Sorting and Related Functions</a></li><li><a class="tocitem" href="../../base/iterators/">Iteration utilities</a></li><li><a class="tocitem" href="../../base/reflection/">Reflection and introspection</a></li><li><a class="tocitem" href="../../base/c/">C Interface</a></li><li><a class="tocitem" href="../../base/libc/">C Standard Library</a></li><li><a class="tocitem" href="../../base/stacktraces/">StackTraces</a></li><li><a class="tocitem" href="../../base/simd-types/">SIMD Support</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Standard Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../stdlib/ArgTools/">ArgTools</a></li><li><a class="tocitem" href="../../stdlib/Artifacts/">Artifacts</a></li><li><a class="tocitem" href="../../stdlib/Base64/">Base64</a></li><li><a class="tocitem" href="../../stdlib/CRC32c/">CRC32c</a></li><li><a class="tocitem" href="../../stdlib/Dates/">Dates</a></li><li><a class="tocitem" href="../../stdlib/DelimitedFiles/">Delimited Files</a></li><li><a class="tocitem" href="../../stdlib/Distributed/">Distributed Computing</a></li><li><a class="tocitem" href="../../stdlib/Downloads/">Downloads</a></li><li><a class="tocitem" href="../../stdlib/FileWatching/">File Events</a></li><li><a class="tocitem" href="../../stdlib/Future/">Future</a></li><li><a class="tocitem" href="../../stdlib/InteractiveUtils/">Interactive Utilities</a></li><li><a class="tocitem" href="../../stdlib/JuliaSyntaxHighlighting/">Julia Syntax Highlighting</a></li><li><a class="tocitem" href="../../stdlib/LazyArtifacts/">Lazy Artifacts</a></li><li><a class="tocitem" href="../../stdlib/LibCURL/">LibCURL</a></li><li><a class="tocitem" href="../../stdlib/LibGit2/">LibGit2</a></li><li><a class="tocitem" href="../../stdlib/Libdl/">Dynamic Linker</a></li><li><a class="tocitem" href="../../stdlib/LinearAlgebra/">Linear Algebra</a></li><li><a class="tocitem" href="../../stdlib/Logging/">Logging</a></li><li><a class="tocitem" href="../../stdlib/Markdown/">Markdown</a></li><li><a class="tocitem" href="../../stdlib/Mmap/">Memory-mapped I/O</a></li><li><a class="tocitem" href="../../stdlib/NetworkOptions/">Network Options</a></li><li><a class="tocitem" href="../../stdlib/Pkg/">Pkg</a></li><li><a class="tocitem" href="../../stdlib/Printf/">Printf</a></li><li><a class="tocitem" href="../../stdlib/Profile/">Profiling</a></li><li><a class="tocitem" href="../../stdlib/REPL/">The Julia REPL</a></li><li><a class="tocitem" href="../../stdlib/Random/">Random Numbers</a></li><li><a class="tocitem" href="../../stdlib/SHA/">SHA</a></li><li><a class="tocitem" href="../../stdlib/Serialization/">Serialization</a></li><li><a class="tocitem" href="../../stdlib/SharedArrays/">Shared Arrays</a></li><li><a class="tocitem" href="../../stdlib/Sockets/">Sockets</a></li><li><a class="tocitem" href="../../stdlib/SparseArrays/">Sparse Arrays</a></li><li><a class="tocitem" href="../../stdlib/Statistics/">Statistics</a></li><li><a class="tocitem" href="../../stdlib/StyledStrings/">StyledStrings</a></li><li><a class="tocitem" href="../../stdlib/TOML/">TOML</a></li><li><a class="tocitem" href="../../stdlib/Tar/">Tar</a></li><li><a class="tocitem" href="../../stdlib/Test/">Unit Testing</a></li><li><a class="tocitem" href="../../stdlib/UUIDs/">UUIDs</a></li><li><a class="tocitem" href="../../stdlib/Unicode/">Unicode</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Developer Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Documentation of Julia&#39;s Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../devdocs/init/">Initialization of the Julia runtime</a></li><li><a class="tocitem" href="../../devdocs/ast/">Julia ASTs</a></li><li><a class="tocitem" href="../../devdocs/types/">More about types</a></li><li><a class="tocitem" href="../../devdocs/object/">Memory layout of Julia Objects</a></li><li><a class="tocitem" href="../../devdocs/eval/">Eval of Julia code</a></li><li><a class="tocitem" href="../../devdocs/callconv/">Calling Conventions</a></li><li><a class="tocitem" href="../../devdocs/compiler/">High-level Overview of the Native-Code Generation Process</a></li><li><a class="tocitem" href="../../devdocs/functions/">Julia Functions</a></li><li><a class="tocitem" href="../../devdocs/cartesian/">Base.Cartesian</a></li><li><a class="tocitem" href="../../devdocs/meta/">Talking to the compiler (the <code>:meta</code> mechanism)</a></li><li><a class="tocitem" href="../../devdocs/subarrays/">SubArrays</a></li><li><a class="tocitem" href="../../devdocs/isbitsunionarrays/">isbits Union Optimizations</a></li><li><a class="tocitem" href="../../devdocs/sysimg/">System Image Building</a></li><li><a class="tocitem" href="../../devdocs/pkgimg/">Package Images</a></li><li><a class="tocitem" href="../../devdocs/llvm-passes/">Custom LLVM Passes</a></li><li><a class="tocitem" href="../../devdocs/llvm/">Working with LLVM</a></li><li><a class="tocitem" href="../../devdocs/stdio/">printf() and stdio in the Julia runtime</a></li><li><a class="tocitem" href="../../devdocs/boundscheck/">Bounds checking</a></li><li><a class="tocitem" href="../../devdocs/locks/">Proper maintenance and care of multi-threading locks</a></li><li><a class="tocitem" href="../../devdocs/offset-arrays/">Arrays with custom indices</a></li><li><a class="tocitem" href="../../devdocs/require/">Module loading</a></li><li><a class="tocitem" href="../../devdocs/inference/">Inference</a></li><li><a class="tocitem" href="../../devdocs/ssair/">Julia SSA-form IR</a></li><li><a class="tocitem" href="../../devdocs/EscapeAnalysis/"><code>EscapeAnalysis</code></a></li><li><a class="tocitem" href="../../devdocs/aot/">Ahead of Time Compilation</a></li><li><a class="tocitem" href="../../devdocs/gc-sa/">Static analyzer annotations for GC correctness in C code</a></li><li><a class="tocitem" href="../../devdocs/gc/">Garbage Collection in Julia</a></li><li><a class="tocitem" href="../../devdocs/gc-mmtk/">Julia + MMTk</a></li><li><a class="tocitem" href="../../devdocs/jit/">JIT Design and Implementation</a></li><li><a class="tocitem" href="../../devdocs/builtins/">Core.Builtins</a></li><li><a class="tocitem" href="../../devdocs/precompile_hang/">Fixing precompilation hangs due to open tasks or IO</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Developing/debugging Julia&#39;s C code</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../devdocs/backtraces/">Reporting and analyzing crashes (segfaults)</a></li><li><a class="tocitem" href="../../devdocs/debuggingtips/">gdb debugging tips</a></li><li><a class="tocitem" href="../../devdocs/valgrind/">Using Valgrind with Julia</a></li><li><a class="tocitem" href="../../devdocs/external_profilers/">External Profiler Support</a></li><li><a class="tocitem" href="../../devdocs/sanitizers/">Sanitizer support</a></li><li><a class="tocitem" href="../../devdocs/probes/">Instrumenting Julia with DTrace, and bpftrace</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Building Julia</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../devdocs/build/build/">Building Julia (Detailed)</a></li><li><a class="tocitem" href="../../devdocs/build/linux/">Linux</a></li><li><a class="tocitem" href="../../devdocs/build/macos/">macOS</a></li><li><a class="tocitem" href="../../devdocs/build/windows/">Windows</a></li><li><a class="tocitem" href="../../devdocs/build/freebsd/">FreeBSD</a></li><li><a class="tocitem" href="../../devdocs/build/arm/">ARM (Linux)</a></li><li><a class="tocitem" href="../../devdocs/build/riscv/">RISC-V (Linux)</a></li><li><a class="tocitem" href="../../devdocs/build/distributing/">Binary distributions</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>The World Age mechanism</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The World Age mechanism</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaLang/julia" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaLang/julia/blob/master/doc/src/manual/worldage.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="The-World-Age-mechanism"><a class="docs-heading-anchor" href="#The-World-Age-mechanism">The World Age mechanism</a><a id="The-World-Age-mechanism-1"></a><a class="docs-heading-anchor-permalink" href="#The-World-Age-mechanism" title="Permalink"></a></h1><div class="admonition is-info" id="Note-ceeb9d4e316149fb"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-ceeb9d4e316149fb" title="Permalink"></a></header><div class="admonition-body"><p>World age is an advanced concept. For the vast majority of Julia users, the world age mechanism operates invisibly in the background. This documentation is intended for the few users who may encounter world-age related issues or error messages.</p></div></div><div class="admonition is-compat" id="Julia-1.12-99a1f9bf255be9df"><header class="admonition-header">Julia 1.12<a class="admonition-anchor" href="#Julia-1.12-99a1f9bf255be9df" title="Permalink"></a></header><div class="admonition-body"><p>Prior to Julia 1.12, the world age mechanism did not apply to changes to the global binding table. The documentation in this chapter is specific to Julia 1.12+.</p></div></div><div class="admonition is-warning" id="Warning-c9570259b2342bfc"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-c9570259b2342bfc" title="Permalink"></a></header><div class="admonition-body"><p>This manual chapter uses internal functions to introspect world age and runtime data structures as an explanatory aid. In general, unless otherwise noted the world age mechanism is not a stable interface and should be interacted with in packages through stable APIs (e.g. <code>invokelatest</code>) only. In particular, do not assume that world ages are always integers or that they have a linear order.</p></div></div><h2 id="World-age-in-general"><a class="docs-heading-anchor" href="#World-age-in-general">World age in general</a><a id="World-age-in-general-1"></a><a class="docs-heading-anchor-permalink" href="#World-age-in-general" title="Permalink"></a></h2><p>The &quot;world age counter&quot; is a monotonically increasing counter that is incremented for every change to the global method table or the global binding table (e.g. through method definition, type definition, <code>import</code>/<code>using</code> declaration, creation of (typed) globals or definition of constants).</p><p>The current value of the global world age counter can be retrieved using the (internal) function <a href="#Base.get_world_counter"><code>Base.get_world_counter</code></a>.</p><pre><code class="language-julia-repl hljs">julia&gt; Base.get_world_counter()
0x0000000000009632

julia&gt; const x = 1

julia&gt; Base.get_world_counter()
0x0000000000009633</code></pre><p>In addition, each <a href="../../base/parallel/#Core.Task"><code>Task</code></a> stores a local world age that determines which modifications to the global binding and method tables are currently visible to the running task. The world age of the running task will never exceed the global world age counter, but may run arbitrarily behind it. In general the term &quot;current world age&quot; refers to the local world age of the currently running task. The current world age may be retrieved using the (internal) function <a href="#Base.tls_world_age"><code>Base.tls_world_age</code></a></p><pre><code class="language-julia-repl hljs">julia&gt; function f end
f (generic function with 0 methods)

julia&gt; begin
           @show (Int(Base.get_world_counter()), Int(Base.tls_world_age()))
           Core.eval(@__MODULE__, :(f() = 1))
           @show (Int(Base.get_world_counter()), Int(Base.tls_world_age()))
           f()
       end
(Int(Base.get_world_counter()), Int(Base.tls_world_age())) = (38452, 38452)
(Int(Base.get_world_counter()), Int(Base.tls_world_age())) = (38453, 38452)
ERROR: MethodError: no method matching f()
The applicable method may be too new: running in current world age 38452, while global world is 38453.

Closest candidates are:
  f() (method too new to be called from this world context.)
   @ Main REPL[2]:3

Stacktrace:
 [1] top-level scope
   @ REPL[2]:5

julia&gt; (f(), Int(Base.tls_world_age()))
(1, 38453)</code></pre><p>Here the definition of the method <code>f</code> raised the global world counter, but the current world age did not change. As a result, the definition of <code>f</code> was not visible in the currently executing task and a <a href="../../base/base/#Core.MethodError"><code>MethodError</code></a> resulted.</p><div class="admonition is-info" id="Note-5c5f33f0b3e0491d"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-5c5f33f0b3e0491d" title="Permalink"></a></header><div class="admonition-body"><p>The method error printing provided additional information that <code>f()</code> is available in a newer world age. This information is added by the error display, not the task that threw the <code>MethodError</code>. The thrown <code>MethodError</code> is identical whether or not a matching definition of <code>f()</code> exists in a newer world age.</p></div></div><p>However, note that the definition of <code>f()</code> was subsequently available at the next REPL prompt, because the current task&#39;s world age had been raised. In general, certain syntactic constructs (in particular most definitions) will raise the current task&#39;s world age to the latest global world age, thus making all changes (both from the current task and any concurrently executing other tasks) visible. The following statements raise the current world age:</p><ol><li>An explicit invocation of <code>Core.@latestworld</code></li><li>The start of every top-level statement</li><li>The start of every REPL prompt</li><li>Any type or struct definition</li><li>Any method definition</li><li>Any constant declaration</li><li>Any global variable declaration (but not a global variable assignment)</li><li>Any <code>using</code>, <code>import</code>, <code>export</code> or <code>public</code> statement</li><li>Certain other macros like <a href="../../base/base/#Base.@eval"><code>@eval</code></a> (depends on the macro implementation)</li></ol><p>Note, however, that the current task&#39;s world age may only ever be permanently incremented at top level. As a general rule, using any of the above statements in non-top-level scope is a syntax error:</p><pre><code class="language-julia-repl hljs">julia&gt; f() = Core.@latestworld
ERROR: syntax: World age increment not at top level
Stacktrace:
 [1] top-level scope
   @ REPL[5]:1</code></pre><p>When it isn&#39;t (for example for <code>@eval</code>), the world age side effect is ignored.</p><p>As a result of these rules, Julia may assume that the world age does not change within the execution of an ordinary function.</p><pre><code class="language-julia hljs">function my_function()
    before = Base.tls_world_age()
    # Any arbitrary code
    after = Base.tls_world_age()
    @assert before === after # always true
end</code></pre><p>This is the key invariant that allows Julia to optimize based on the current state of its global data structures, while still having the well-defined ability to change these data structures.</p><h2 id="Temporarily-raising-the-world-age-using-invokelatest"><a class="docs-heading-anchor" href="#Temporarily-raising-the-world-age-using-invokelatest">Temporarily raising the world age using <code>invokelatest</code></a><a id="Temporarily-raising-the-world-age-using-invokelatest-1"></a><a class="docs-heading-anchor-permalink" href="#Temporarily-raising-the-world-age-using-invokelatest" title="Permalink"></a></h2><p>As described above, it is not possible to permanently raise the world age for the remainder of a <code>Task</code>&#39;s execution unless the task is executing top-level statements. However, it is possible to temporarily change the world age in a scoped manner using <code>invokelatest</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; function f end
f (generic function with 0 methods)

julia&gt; begin
           Core.eval(@__MODULE__, :(f() = 1))
           invokelatest(f)
       end
1</code></pre><p><code>invokelatest</code> will temporarily raise the current task&#39;s world age to the latest global world age (at entry to <code>invokelatest</code>) and execute the provided function. Note that the world age will return to its prior value upon exit from <code>invokelatest</code>.</p><h2 id="World-age-and-const-struct-redefinitions"><a class="docs-heading-anchor" href="#World-age-and-const-struct-redefinitions">World age and const struct redefinitions</a><a id="World-age-and-const-struct-redefinitions-1"></a><a class="docs-heading-anchor-permalink" href="#World-age-and-const-struct-redefinitions" title="Permalink"></a></h2><p>The semantics described above for method redefinition also apply to redefinition of constants:</p><pre><code class="language-julia-repl hljs">julia&gt; const x = 1
1

julia&gt; get_const() = x
get_const (generic function with 1 method)

julia&gt; begin
           @show get_const()
           Core.eval(@__MODULE__, :(const x = 2))
           @show get_const()
           Core.@latestworld
           @show get_const()
       end
get_const() = 1
get_const() = 1
get_const() = 2
2</code></pre><p>However, for the avoidance of doubt, they do not apply to ordinary assignment to global variables, which becomes visible immediately:</p><pre><code class="language-julia-repl hljs">julia&gt; global y = 1
1

julia&gt; get_global() = y
get_global (generic function with 1 method)

julia&gt; begin
           @show get_global()
           Core.eval(@__MODULE__, :(y = 2))
           @show get_global()
       end
get_global() = 1
get_global() = 2
2</code></pre><p>One particular special case of constant reassignment is the redefinition of struct types:</p><pre><code class="language-julia-repl hljs">julia&gt; struct MyStruct
           x::Int
       end

julia&gt; const one_field = MyStruct(1)
MyStruct(1)

julia&gt; struct MyStruct
           x::Int
           y::Float64
       end

julia&gt; const two_field = MyStruct(1, 2.0)
MyStruct(1, 2.0)

julia&gt; one_field
@world(MyStruct, 38452:38455)(1)

julia&gt; two_field
MyStruct(1, 2.0)</code></pre><p>Internally the two definitions of <code>MyStruct</code> are entirely separate types. However, after the new <code>MyStruct</code> type is defined, there is no longer any default binding for the original definition of <code>MyStruct</code>. To nevertheless facilitate access to these types, the special <a href="#Base.@world"><code>@world</code></a> macro may be used to access the meaning of a name in a previous world. However, this facility is intended for introspection only and in particular note that world age numbers are not stable across precompilation and should in general be treated opaquely.</p><h3 id="Binding-partition-introspection"><a class="docs-heading-anchor" href="#Binding-partition-introspection">Binding partition introspection</a><a id="Binding-partition-introspection-1"></a><a class="docs-heading-anchor-permalink" href="#Binding-partition-introspection" title="Permalink"></a></h3><p>In certain cases, it can be helpful to introspect the system&#39;s understanding of what a binding means in any particular world age. The default display printing of <code>Core.Binding</code> provides a helpful summary (e.g. on the <code>MyStruct</code> example from above):</p><pre><code class="language-julia-repl hljs">julia&gt; convert(Core.Binding, GlobalRef(@__MODULE__, :MyStruct))
Binding Main.MyStruct
   38456:∞ - constant binding to MyStruct
   38452:38455 - constant binding to @world(MyStruct, 38452:38455)
   38451:38451 - backdated constant binding to @world(MyStruct, 38452:38455)
   0:38450 - backdated constant binding to @world(MyStruct, 38452:38455)</code></pre><h2 id="World-age-and-using/import"><a class="docs-heading-anchor" href="#World-age-and-using/import">World age and <code>using</code>/<code>import</code></a><a id="World-age-and-using/import-1"></a><a class="docs-heading-anchor-permalink" href="#World-age-and-using/import" title="Permalink"></a></h2><p>Bindings provided via <code>using</code> and <code>import</code> also operate via the world age mechanism. Binding resolution is a stateless function of the <code>import</code> and <code>using</code> definitions visible in the current world age. For example:</p><pre><code class="language-julia-repl hljs">julia&gt; module M1; const x = 1; export x; end

julia&gt; module M2; const x = 2; export x; end

julia&gt; using .M1

julia&gt; x
1

julia&gt; using .M2

julia&gt; x
ERROR: UndefVarError: `x` not defined in `Main`
Hint: It looks like two or more modules export different bindings with this name, resulting in ambiguity. Try explicitly importing it from a particular module, or qualifying the name with the module it should come from.

julia&gt; convert(Core.Binding, GlobalRef(@__MODULE__, :x))
Binding Main.x
   38458:∞ - ambiguous binding - guard entry
   38457:38457 - implicit `using` resolved to constant 1</code></pre><h2 id="World-age-capture"><a class="docs-heading-anchor" href="#World-age-capture">World age capture</a><a id="World-age-capture-1"></a><a class="docs-heading-anchor-permalink" href="#World-age-capture" title="Permalink"></a></h2><p>Certain language features capture the current task&#39;s world age. Perhaps the most common of these is creation of new tasks. Newly created tasks will inherit the creating task&#39;s local world age at creation time and will retain said world age (unless explicitly raised) even if the originating tasks raises its world age:</p><pre><code class="language-julia-repl hljs">julia&gt; const x = 1

julia&gt; t = @task (wait(); println(&quot;Running now&quot;); x);

julia&gt; const x = 2

julia&gt; schedule(t);
Running now

julia&gt; x
2

julia&gt; fetch(t)
1</code></pre><p>In addition to tasks, opaque closures also capture their world age at creation. See <a href="#Base.Experimental.@opaque"><code>Base.Experimental.@opaque</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.@world" href="#Base.@world"><code>Base.@world</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@world(sym, world)</code></pre><p>Resolve the binding <code>sym</code> in world <code>world</code>. See <a href="#Base.invoke_in_world"><code>invoke_in_world</code></a> for running arbitrary code in fixed worlds. <code>world</code> may be <code>UnitRange</code>, in which case the macro will error unless the binding is valid and has the same value across the entire world range.</p><p>As a special case, the world <code>∞</code> always refers to the latest world, even if that world is newer than the world currently running.</p><p>The <code>@world</code> macro is primarily used in the printing of bindings that are no longer available in the current world.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; struct Foo; a::Int; end
Foo

julia&gt; fold = Foo(1)

julia&gt; Int(Base.get_world_counter())
26866

julia&gt; struct Foo; a::Int; b::Int end
Foo

julia&gt; fold
@world(Foo, 26866)(1)</code></pre><div class="admonition is-compat" id="Julia-1.12-839a790198b1214d"><header class="admonition-header">Julia 1.12<a class="admonition-anchor" href="#Julia-1.12-839a790198b1214d" title="Permalink"></a></header><div class="admonition-body"><p>This functionality requires at least Julia 1.12.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/e3982cd84030e4baf7b8e97119bbeec0fa982935/base/essentials.jl#L1240-L1273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.get_world_counter" href="#Base.get_world_counter"><code>Base.get_world_counter</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_world_counter()</code></pre><p>Returns the current maximum world-age counter. This counter is global and monotonically increasing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/e3982cd84030e4baf7b8e97119bbeec0fa982935/base/runtime_internals.jl#L1306-L1311">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.tls_world_age" href="#Base.tls_world_age"><code>Base.tls_world_age</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tls_world_age()</code></pre><p>Returns the world the <a href="../../base/parallel/#Base.current_task">current_task()</a> is executing within.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/e3982cd84030e4baf7b8e97119bbeec0fa982935/base/runtime_internals.jl#L1314-L1318">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.invoke_in_world" href="#Base.invoke_in_world"><code>Base.invoke_in_world</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">invoke_in_world(world, f, args...; kwargs...)</code></pre><p>Call <code>f(args...; kwargs...)</code> in a fixed world age, <code>world</code>.</p><p>This is useful for infrastructure running in the user&#39;s Julia session which is not part of the user&#39;s program. For example, things related to the REPL, editor support libraries, etc. In these cases it can be useful to prevent unwanted method invalidation and recompilation latency, and to prevent the user from breaking supporting infrastructure by mistake.</p><p>The global world age can be queried using <a href="#Base.get_world_counter"><code>Base.get_world_counter()</code></a> and stored for later use within the lifetime of the current Julia session, or when serializing and reloading the system image.</p><p>Technically, <code>invoke_in_world</code> will prevent any function called by <code>f</code> from being extended by the user during their Julia session. That is, generic function method tables seen by <code>f</code> (and any functions it calls) will be frozen as they existed at the given <code>world</code> age. In a sense, this is like the opposite of <a href="../../base/base/#Base.invokelatest"><code>invokelatest</code></a>.</p><div class="admonition is-info" id="Note-e7c8cff96537928c"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-e7c8cff96537928c" title="Permalink"></a></header><div class="admonition-body"><p>It is not valid to store world ages obtained in precompilation for later use. This is because precompilation generates a &quot;parallel universe&quot; where the world age refers to system state unrelated to the main Julia session.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/e3982cd84030e4baf7b8e97119bbeec0fa982935/base/Base_compiler.jl#L257-L282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.Experimental.@opaque" href="#Base.Experimental.@opaque"><code>Base.Experimental.@opaque</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@opaque ([type, ]args...) -&gt; body</code></pre><p>Marks a given closure as &quot;opaque&quot;. Opaque closures capture the world age of their creation (as opposed to their invocation). This allows for more aggressive optimization of the capture list, but trades off against the ability to inline opaque closures at the call site, if their creation is not statically visible.</p><p>An argument tuple type (<code>type</code>) may optionally be specified, to specify allowed argument types in a more flexible way. In particular, the argument type may be fixed length even if the function is variadic.</p><div class="admonition is-warning" id="Warning-844f2574a59481b"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-844f2574a59481b" title="Permalink"></a></header><div class="admonition-body"><p>This interface is experimental and subject to change or removal without notice.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/e3982cd84030e4baf7b8e97119bbeec0fa982935/base/opaque_closure.jl#L3-L19">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../command-line-interface/">« Command-line Interface</a><a class="docs-footer-nextpage" href="../../base/base/">Essentials »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Thursday 22 May 2025 03:15">Thursday 22 May 2025</span>. Using Julia version 1.13.0-DEV.624.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
